<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro - Laberinto Educativo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .bg-pattern {
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%239C92AC' fill-opacity='0.1'%3E%3Cpath d='M15 15h20v20H15zM65 15h20v20H65zM15 65h20v20H15zM65 65h20v20H65z'/%3E%3C/g%3E%3C/svg%3E");
            animation: scrollBackground 30s linear infinite;
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        .game-icon {
            position: absolute;
            opacity: 0.1;
            transform-origin: center;
        }
        .rotate-animation {
            animation: rotate 20s linear infinite;
        }
        .float-slow {
            animation: float 6s ease-in-out infinite;
        }
        .float-medium {
            animation: float 4s ease-in-out infinite;
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .input-focus {
            transition: all 0.3s ease;
        }
        .input-focus:focus {
            transform: scale(1.02);
            box-shadow: 0 0 15px rgba(147, 51, 234, 0.3);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-green-100 via-blue-100 to-purple-100 min-h-screen bg-pattern relative overflow-hidden">
    <!-- Iconos de fondo animados -->
    <div class="fixed inset-0 pointer-events-none">
        <!-- Superhéroe -->
        <svg class="game-icon w-24 h-24 left-1/4 top-1/4 rotate-animation" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2L4 5v6.09c0 5.05 3.41 9.76 8 10.91 4.59-1.15 8-5.86 8-10.91V5l-8-3zm6 9.09c0 4-2.55 7.7-6 8.83-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25 6 2.25v4.7z"/>
        </svg>
        <!-- Varita mágica -->
        <svg class="game-icon w-16 h-16 right-1/4 top-1/3 float-medium" viewBox="0 0 24 24" fill="currentColor">
            <path d="M7.5 5.6L5 7l1.4-2.5L5 2l2.5 1.4L10 2 8.6 4.5 10 7 7.5 5.6zm12 9.8L22 14l-1.4 2.5L22 19l-2.5-1.4L17 19l1.4-2.5L17 14l2.5 1.4zM22 2l-1.4 2.5L22 7l-2.5-1.4L17 7l1.4-2.5L17 2l2.5 1.4L22 2zm-8.66 10.78l2.44-2.44-2.44-2.44L15 6.56l2.44 2.44L19.88 6.5l1.33 1.33-2.44 2.44 2.44 2.44L19.88 14l-2.44-2.44L15 13.89z"/>
        </svg>
        <!-- Escudo -->
        <svg class="game-icon w-20 h-20 left-1/3 bottom-1/4 float-slow" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/>
        </svg>
        <!-- Estrella de poder -->
        <svg class="game-icon w-24 h-24 right-1/3 top-1/4 rotate-animation" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
        </svg>
        <!-- Gema mágica -->
        <svg class="game-icon w-20 h-20 left-1/5 bottom-1/3 float-medium" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
        </svg>
    </div>

    <div class="flex flex-col items-center justify-center min-h-screen p-4">
        <!-- Contenedor del formulario con efecto de cristal -->
        <div class="text-center bg-white bg-opacity-80 backdrop-blur-md p-8 rounded-2xl shadow-xl w-full max-w-md mx-auto relative overflow-hidden border border-white border-opacity-20">
            <!-- Decoraciones de fondo -->
            <div class="absolute top-0 left-0 w-32 h-32 bg-green-200 rounded-full -translate-x-1/2 -translate-y-1/2 blur-xl"></div>
            <div class="absolute bottom-0 right-0 w-32 h-32 bg-purple-200 rounded-full translate-x-1/2 translate-y-1/2 blur-xl"></div>

            <h1 class="text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-600 to-blue-600 mb-6 float-animation">
                ¡Únete a la Aventura! 🎮
            </h1>

            <div id="error-message" class="hidden text-red-500 bg-red-100 p-3 rounded-lg mb-4"></div>

            <form id="register-form" onsubmit="return handleRegister(event)" class="space-y-6">
                <div class="space-y-2">
                    <label for="username" class="block text-left text-lg font-medium text-gray-700">
                        🦸‍♂️ Elige tu nombre de héroe:
                    </label>
                    <input type="text" id="username" name="username" required
                           class="input-focus w-full p-4 text-lg border border-green-200 rounded-xl bg-white bg-opacity-90 focus:outline-none focus:border-green-400">
                </div>

                <div class="space-y-2">
                    <label for="password" class="block text-left text-lg font-medium text-gray-700">
                        🔐 Crea tu código secreto:
                    </label>
                    <input type="password" id="password" name="password" required
                           class="input-focus w-full p-4 text-lg border border-green-200 rounded-xl bg-white bg-opacity-90 focus:outline-none focus:border-green-400">
                </div>

                <div class="space-y-2">
                    <label for="confirm-password" class="block text-left text-lg font-medium text-gray-700">
                        ✨ Confirma tu código secreto:
                    </label>
                    <input type="password" id="confirm-password" name="confirm-password" required
                           class="input-focus w-full p-4 text-lg border border-green-200 rounded-xl bg-white bg-opacity-90 focus:outline-none focus:border-green-400">
                </div>

                <button type="submit" 
                        class="w-full py-4 bg-gradient-to-r from-green-500 to-blue-500 text-white text-lg font-bold rounded-xl hover:from-green-600 hover:to-blue-600 transform hover:-translate-y-1 transition-all duration-300 shadow-lg hover:shadow-xl">
                    🚀 ¡Comenzar mi Aventura!
                </button>
            </form>

            <div class="mt-6 text-gray-600">
                ¿Ya eres un héroe? 
                <a href="login.html" class="text-green-600 hover:text-green-700 font-semibold hover:underline">
                    ¡Ingresa aquí! 🎯
                </a>
            </div>
        </div>
    </div>

    <script>
        async function handleRegister(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            const errorMessage = document.getElementById('error-message');
            
            if (password !== confirmPassword) {
                errorMessage.textContent = '❌ ¡Ups! Los códigos secretos no coinciden';
                errorMessage.classList.remove('hidden');
                return false;
            }
            
            try {
                const response = await fetch('http://localhost:4000/api/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username,
                        password
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    alert('🎉 ¡Genial! Tu cuenta de héroe está lista. ¡Hora de iniciar sesión!');
                    window.location.href = 'login.html';
                } else {
                    errorMessage.textContent = '❌ ' + (data.message || '¡Ups! Algo salió mal en el registro');
                    errorMessage.classList.remove('hidden');
                }
            } catch (error) {
                console.error('Error:', error);
                errorMessage.textContent = '❌ ¡Ups! No pudimos conectar con el servidor';
                errorMessage.classList.remove('hidden');
            }
            
            return false;
        }
    </script>
</body>
</html>